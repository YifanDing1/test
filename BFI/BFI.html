<html>
<head>
  <title>Demo</title>
  <script src="jspsych.js"></script>
  <script src="jspsych-instructions.js"></script>
  <script src="jspsych-html-keyboard-response.js"></script>
  <script src="jspsych-plugin-survey-multi-choice.js"></script>
  <link href="jspsych.css" rel="stylesheet" type="text/css" />
</head>
<body></body>
<script>
  let modifiedData = [];
  let responseText = "";
  function mapResponseToNumber(response) {
  const mapping = {
    'Disagree strongly': 1,
    'Disagree a little': 2,
    'Neutral; no opinion': 3,
    'Agree a little': 4,
    'Agree strongly': 5
  };
  return mapping[response] || 0; // Return 0 or some default value for unrecognized responses
}

  let instruction = {
    type: jsPsychInstructions,
    pages: function(){
      let pageOne = '<div style="font-size:20px;"><b>INSTRUCTIONS</b><br><br><br>This is the The Big Five Inventory demo. <br><br><br></div>'
      return [pageOne]
    },
    allow_backward: false,
    button_label_next: "Next",
    show_clickable_nav: true
  }

  let BFI1 = {
    type: jsPsychSurveyMultiChoice,
    questions: [
      {
        prompt: "Is outgoing, sociable.",
        name: '1',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is compassionate, has a soft heart.",
        name: '2',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Tends to be disorganized.",
        name: '3',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is relaxed, handles stress well.",
        name: '4',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Has few artistic interests.",
        name: '5',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Has an assertive personality.",
        name: '6',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is respectful, treats others with respect.",
        name: '7',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Tends to be lazy.",
        name: '8',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Stays optimistic after experiencing a setback.",
        name: '9',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is curious about many different things.",
        name: '10',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
    ],
    on_finish: function(data) {
      let responses = data.response;
      for (let questionName in responses) {
        if (responses.hasOwnProperty(questionName)) {
          // Construct an object that matches your database schema
          let responseText = responses[questionName];
          let dbRow = {
            question: questionName,
            response: responseText,
            score: mapResponseToNumber(responseText),
            // Add other fields as necessary, matching your database columns
          };
          modifiedData.push(dbRow);
        }
      }
    }
  }

  let BFI2 = {
    type: jsPsychSurveyMultiChoice,
    questions: [
      {
        prompt: "Rarely feels excited or eager.",
        name: '11',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Tends to find fault with others.",
        name: '12',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is dependable, steady.",
        name: '13',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is moody, has up and down mood swings.",
        name: '14',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is inventive, finds clever ways to do things.",
        name: '15',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Tends to be quiet.",
        name: '16',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Feels little sympathy for others.",
        name: '17',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is systematic, likes to keep things in order.",
        name: '18',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Can be tense.",
        name: '19',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is fascinated by art, music, or literature.",
        name: '20',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
    ],
    on_finish: function(data) {
      let responses = data.response;
      for (let questionName in responses) {
        if (responses.hasOwnProperty(questionName)) {
          // Construct an object that matches your database schema
          let responseText = responses[questionName];
          let dbRow = {
            question: questionName,
            response: responseText,
            score: mapResponseToNumber(responseText),
            // Add other fields as necessary, matching your database columns
          };
          modifiedData.push(dbRow);
        }
      }
    }
  }

  let BFI3 = {
    type: jsPsychSurveyMultiChoice,
    questions: [
      {
        prompt: "Is dominant, acts as a leader.",
        name: '21',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Starts arguments with others.",
        name: '22',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Has difficulty getting started on tasks.",
        name: '23',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Feels secure, comfortable with self.",
        name: '24',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Avoids intellectual, philosophical discussions.",
        name: '25',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is less active than other people.",
        name: '26',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Has a forgiving nature.",
        name: '27',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Can be somewhat careless.",
        name: '28',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is emotionally stable, not easily upset.",
        name: '29',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Has little creativity.",
        name: '30',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
    ],
    on_finish: function(data) {
      let responses = data.response;
      for (let questionName in responses) {
        if (responses.hasOwnProperty(questionName)) {
          // Construct an object that matches your database schema
          let responseText = responses[questionName];
          let dbRow = {
            question: questionName,
            response: responseText,
            score: mapResponseToNumber(responseText),
            // Add other fields as necessary, matching your database columns
          };
          modifiedData.push(dbRow);
        }
      }
    }
  }

  let BFI4 = {
    type: jsPsychSurveyMultiChoice,
    questions: [
      {
        prompt: "Is sometimes shy, introverted.",
        name: '31',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is helpful and unselfish with others.",
        name: '32',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Keeps things neat and tidy.",
        name: '33',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Worries a lot.",
        name: '34',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Values art and beauty.",
        name: '35',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Finds it hard to influence people.",
        name: '36',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is sometimes rude to others.",
        name: '37',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is efficient, gets things done.",
        name: '38',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Often feels sad.",
        name: '39',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is complex, a deep thinker.",
        name: '40',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
    ],
    on_finish: function(data) {
      let responses = data.response;
      for (let questionName in responses) {
        if (responses.hasOwnProperty(questionName)) {
          // Construct an object that matches your database schema
          let responseText = responses[questionName];
          let dbRow = {
            question: questionName,
            response: responseText,
            score: mapResponseToNumber(responseText),
            // Add other fields as necessary, matching your database columns
          };
          modifiedData.push(dbRow);
        }
      }
    }
  }

  let BFI5 = {
    type: jsPsychSurveyMultiChoice,
    questions: [
      {
        prompt: "Is full of energy.",
        name: '41',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is suspicious of others/' intentions.",
        name: '42',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is reliable, can always be counted on.",
        name: '43',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Keeps their emotions under control.",
        name: '44',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Has difficulty imagining things.",
        name: '45',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is talkative.",
        name: '46',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Can be cold and uncaring.",
        name: '47',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Leaves a mess, doesn/'t clean up.",
        name: '48',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Rarely feels anxious or afraid.",
        name: '49',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Thinks poetry and plays are boring.",
        name: '50',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
    ],
    on_finish: function(data) {
      let responses = data.response;
      for (let questionName in responses) {
        if (responses.hasOwnProperty(questionName)) {
          // Construct an object that matches your database schema
          let responseText = responses[questionName];
          let dbRow = {
            question: questionName,
            response: responseText,
            score: mapResponseToNumber(responseText),
            // Add other fields as necessary, matching your database columns
          };
          modifiedData.push(dbRow);
        }
      }
    }
  }

  let BFI6 = {
    type: jsPsychSurveyMultiChoice,
    questions: [
      {
        prompt: "Prefers to have others take charge.",
        name: '51',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is polite, courteous to others.",
        name: '52',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is persistent, works until the task is finished.",
        name: '53',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Tends to feel depressed, blue.",
        name: '54',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Has little interest in abstract ideas.",
        name: '55',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Shows a lot of enthusiasm.",
        name: '56',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Assumes the best about people.",
        name: '57',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Sometimes behaves irresponsibly.",
        name: '58',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is temperamental, gets emotional easily.",
        name: '59',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
      {
        prompt: "Is original, comes up with new ideas.",
        name: '60',
        options: ['Disagree strongly', 'Disagree a little', 'Neutral; no opinion', 'Agree a little', 'Agree strongly'],
        required: true
      },
    ],
    on_finish: function(data) {
      let responses = data.response;
      for (let questionName in responses) {
        if (responses.hasOwnProperty(questionName)) {
          // Construct an object that matches your database schema
          let responseText = responses[questionName];
          let dbRow = {
            question: questionName,
            response: responseText,
            score: mapResponseToNumber(responseText),
            // Add other fields as necessary, matching your database columns
          };
          modifiedData.push(dbRow);
        }
      }
    }
  }
  function sendToServer(data) {
    var xhr = new XMLHttpRequest();
    xhr.open('POST', 'data.php', true);
    xhr.setRequestHeader('Content-Type', 'application/json');
    xhr.onreadystatechange = function() {
      if (xhr.readyState === 4 && xhr.status === 200) {
        console.log(xhr.responseText); // Handle the response from the server
      }
    };
    xhr.send(JSON.stringify(data));
  }


  //--------------timeline variables-----------------
  let timeline = [];

  let jsPsych = initJsPsych({
      on_finish() {
        sendToServer(modifiedData);
      }
  });

  timeline.push(instruction, BFI1, BFI2, BFI3, BFI4, BFI5, BFI6);
  jsPsych.run(timeline);

</script>
</html>